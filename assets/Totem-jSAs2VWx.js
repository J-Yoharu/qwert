import{_ as I}from"./Dialog.vue_vue_type_script_setup_true_lang-SAvG1Ojc.js";import{u as U,c as z,g as R,d as j}from"./totem.repository-__MubhNP.js";import{Y as F,c as w,aE as L,r as u,a0 as v,a1 as k,aq as M,ad as P,o as Y,a2 as t,h as o,af as G,V as b,ab as i,av as H,a4 as C,a8 as q,a5 as E,ac as x,i as J,a6 as S,a7 as K,F as B,aj as N,b9 as O}from"./index-CONA2sxp.js";import{a as $,V as Q}from"./VRow-BtGaPkBM.js";import{r as W}from"./VDataTable-C2nslS7o.js";import{V as X}from"./filter-DmElaXHB.js";import{b as Z,V as ee,c as te}from"./VList-yunKllmd.js";import{V as ae}from"./VSheet-DA1WNEfX.js";import"./Form.vue_vue_type_script_setup_true_lang-FBzryxoI.js";import"./VTooltip-BsBGR-xT.js";import"./VSlideGroup-BauSHhHz.js";import"./VTextField-BckJyTD4.js";import"./validator-BJqRYd_8.js";import"./VForm-CFmF0a95.js";import"./ssrBoot-BiPgWirj.js";const oe=F({__name:"TotemDialog",props:{modelValue:{type:Boolean},totem:{}},emits:["update:modelValue","update:totem","save","close"],setup(D,{emit:y}){const f=D,m=y,r=w({get:()=>f.totem,set:s=>m("update:totem",s)}),h=w(()=>r.value.id!==0),d=w(()=>h.value?"Editar Totem":"Adicionar Totem"),g=w({get:()=>f.modelValue,set:s=>m("update:modelValue",s)}),{openAlert:V}=L(),c=u(!1),p=u({title:d,form:{value:r,inputs:[{component:"VTextField",value:"name",label:"Nome",required:!0,on:{}},{component:"VTextField",value:"department_id",label:"Departamento (Integração)",required:!0,on:{}},{component:"VTextarea",value:"description",label:"Descrição",required:!0,on:{}}]},submit:()=>_()});function _(){c.value=!0,(h.value?U(r.value.id,r.value):z(r.value)).then(()=>{g.value=!1,m("save")}).catch(n=>{V("Falha ao salvar totem",n)}).finally(()=>{c.value=!1})}return(s,n)=>(v(),k(I,{loading:c.value,modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=l=>g.value=l),width:"400",form:p.value,onClock:n[1]||(n[1]=l=>m("close"))},null,8,["loading","modelValue","form"]))}}),xe=F({__name:"Totem",setup(D){const y=[{title:"ID",value:"id",align:"start",width:"5%"},{title:"Nome",value:"name",align:"start",width:"20%"},{title:"Descrição",value:"description",align:"start",width:"20%"},{title:"Filas",value:"queues_count",align:"start",width:"5%"},{title:"Telas",value:"screens_count",align:"start",width:"5%"},{title:"Última atualização",value:"updated_at",align:"start",width:"13%"},{title:"",value:"actions",align:"center",width:"2%"}],{openAlert:f,closeAlert:m,openConfirmAlert:r}=L(),h=M(),d=u({name:"",description:"",id:0,queues_count:0,screens_count:0,updated_at:""}),{setBreadcrumbs:g}=P(),V=u(!0),c=u([]),p=u(!1);function _(l=!0){l&&(V.value=!0),R().then(a=>{c.value=a.data}).catch(a=>{console.log({error:a}),f("Erro ao carregar totens",a)}).finally(()=>{V.value=!1})}const s=u([{title:"Editar",slug:"totem.update",action:l=>{d.value={...l},p.value=!0}},{title:"Excluir",slug:"totem.delete",action:l=>{r({title:"Excluir Totem",text:`Deseja realmente excluir o totem <span class="text-no-wrap bg-primary pa-1 rounded">${l.name}</span>?`},a=>{a.value=!0,j(l.id).then(()=>{_(!1),n(),m()}).catch(e=>{f("Erro ao excluir totem",e)}).finally(()=>{a.value=!1})})}},{title:"Executar",slug:"totem.view",action(l){h.push({name:"totem.run",params:{id:l.id}})}}]);function n(){d.value={name:"",description:"",id:0,queues_count:0,screens_count:0,updated_at:""}}return Y(()=>{_(),g([{title:"Totens",name:"true",to:""}])}),(l,a)=>(v(),k(ae,{color:"on-surface",rounded:""},{default:t(()=>[o(Q,null,{default:t(()=>[o($,{class:"d-flex align-center"},{default:t(()=>[G("h1",null,[o(b,{icon:"mdi-monitor-vertical"}),i(" Totens")]),o(H),C(N).acl("totem.create")?(v(),k(q,{key:0,color:"primary",flat:"",onClick:a[0]||(a[0]=e=>p.value=!0)},{default:t(()=>[i(" Novo ")]),_:1})):E("",!0)]),_:1}),o($,{cols:"12"},{default:t(()=>[o(W,{headers:y,items:c.value,loading:V.value,"items-per-page":-1},{"item.name":t(({item:e})=>[o(C(O),{to:{name:"totem.detail",params:{id:e.id}}},{default:t(()=>[i(x(e.name),1)]),_:2},1032,["to"])]),"item.queues_count":t(({item:e})=>[o(b,{icon:"mdi-format-list-bulleted"}),i(" "+x(e.queues_count),1)]),"item.screens_count":t(({item:e})=>[o(b,{icon:"mdi-monitor"}),i(" "+x(e.screens_count),1)]),"item.updated_at":t(({item:e})=>[o(b,{icon:"mdi-calendar"}),i(" "+x(new Date(e.updated_at).toLocaleString()),1)]),"item.actions":t(({item:e})=>[o(X,{left:""},{activator:t(({props:T})=>[o(q,J(T,{icon:"mdi-dots-horizontal",variant:"text"}),null,16)]),default:t(()=>[o(Z,null,{default:t(()=>[(v(!0),S(B,null,K(s.value,(T,A)=>(v(),S(B,null,[C(N).acl(T.slug)?(v(),k(ee,{link:"",onClick:le=>T.action(e),key:A},{default:t(()=>[o(te,null,{default:t(()=>[i(x(T.title),1)]),_:2},1024)]),_:2},1032,["onClick"])):E("",!0)],64))),256))]),_:2},1024)]),_:2},1024)]),bottom:t(()=>[]),_:2},1032,["items","loading"])]),_:1})]),_:1}),o(oe,{onClose:n,onSave:a[1]||(a[1]=e=>{_(!1),n()}),totem:d.value,"onUpdate:totem":a[2]||(a[2]=e=>d.value=e),modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e)},null,8,["totem","modelValue"])]),_:1}))}});export{xe as default};
