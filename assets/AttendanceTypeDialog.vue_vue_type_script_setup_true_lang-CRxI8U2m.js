import{_ as S}from"./Dialog.vue_vue_type_script_setup_true_lang-CiiCaPsN.js";import{bn as _,Y as $,r as g,c as V,a0 as T,a1 as h,a2 as f,h as v,i as E,bA as I,af as w,a6 as L,ab as C,a8 as F,ac as P,a5 as R,an as j}from"./index-eSwy3xtz.js";import{V as z,_ as G}from"./Form.vue_vue_type_script_setup_true_lang-BEkuAhzz.js";import{d as B}from"./default-values-Cei7-cAt.js";import{V as H}from"./VForm-DmbiyfSH.js";function ae(){return _.get("/attendance-type")}function M(u){return _.post("/attendance-type",u)}function O(u,c){return c.append("_method","PUT"),_.post(`/attendance-type/${u}`,c)}function te(u){return _.delete(`/attendance-type/${u}`)}const Y={class:"d-flex align-center"},q=["src"],J={key:0,class:"d-flex justify-end mb-3"},K=$({__name:"AttendanceTypeForm",props:{modelValue:{},hideActions:{type:Boolean,default:!1}},emits:["update:modelValue","submit","cancel"],setup(u,{expose:c,emit:b}){const r=g(!1),m=u;c({save:A});const i=b,o=V({get(){return N(),m.modelValue},set:l=>i("update:modelValue",l)}),p=V(()=>o.value.id?"Atualizar":"Salvar"),e=g({file:[],base64:""}),y=V(()=>({eddited:e.value.base64.length>0,preview:o.value.icon.length?o.value.icon:e.value.base64})),s=g(!1),D=g([{component:"VTextField",value:"name",label:"Nome",props:{trueValue:1,falseValue:0},on:{},cols:{cols:6,md:12}},{component:"VFileInput",value:"icon",label:"Ícone",props:{trueValue:1,falseValue:0},on:{change:async()=>{o.value.icon="",U(e.value.file[0]).then(l=>{e.value.base64=l})}},cols:{cols:6,md:12}},{component:"VTextarea",value:"description",label:"Descrição",props:{trueValue:1,falseValue:0},on:{},cols:{cols:6,md:12}}]);function U(l){return new Promise((a,t)=>{const n=new FileReader;n.readAsDataURL(l),n.onload=()=>a(n.result),n.onerror=()=>t(n.result)})}function A(){if(!r.value)return;s.value=!0;const{icon:l,...a}=o.value,t=new FormData;Object.entries(a).forEach(([d,k])=>{t.append(d,k??null)}),y.value.eddited&&t.set("icon",e.value.file[0]);const n=o.value.id?O(o.value.id,t):M(t);n.then(d=>(x(),d)).finally(()=>{i("submit",n),s.value=!1})}function x(){i("update:modelValue",structuredClone(B.attendanceType)),e.value.base64="",e.value.file=[]}async function N(){var d;const l=m.modelValue.icon;if(!l)return;const a=await fetch(l,{method:"GET",mode:"no-cors"}),t=await a.blob(),n=(d=l.match(/[^/]*$/))==null?void 0:d[0];e.value.file=[new File([t],n??"Não identificado",{type:a.headers.get("Content-Type")})]}return(l,a)=>(T(),h(H,{onSubmit:j(A,["prevent"]),"lazy-validation":"",modelValue:r.value,"onUpdate:modelValue":a[3]||(a[3]=t=>r.value=t)},{default:f(()=>[v(G,{form:D.value,modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=t=>o.value=t)},{"item:icon":f(({props:t,on:n})=>[v(z,E({modelValue:e.value.file,"onUpdate:modelValue":a[0]||(a[0]=d=>e.value.file=d)},I(n),t),{"prepend-inner":f(()=>[w("div",Y,[w("img",{src:y.value.preview,height:"30"},null,8,q)])]),_:2},1040,["modelValue"])]),_:1},8,["form","modelValue"]),l.hideActions?R("",!0):(T(),L("div",J,[v(F,{variant:"text",disabled:s.value,onClick:a[2]||(a[2]=t=>{x(),i("cancel")})},{default:f(()=>[C(" Cancelar ")]),_:1},8,["disabled"]),v(F,{type:"submit",variant:"text",color:"primary",disabled:s.value,loading:s.value},{default:f(()=>[C(P(p.value),1)]),_:1},8,["disabled","loading"])]))]),_:1},8,["modelValue"]))}}),le=$({__name:"AttendanceTypeDialog",props:{modelValue:{type:Boolean},item:{}},emits:["update:modelValue","update:item","submit"],setup(u,{emit:c}){const b=u,r=c,m=V({get(){return b.item},set:p=>r("update:item",p)}),i=V({get(){return b.modelValue},set:p=>r("update:modelValue",p)});function o(){m.value=structuredClone(B.attendanceType)}return(p,e)=>{const y=S;return T(),h(y,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=s=>i.value=s),title:"Tipo de Atendimento","hide-actions":"",onClose:o},{content:f(()=>[v(K,{ref:"form",modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),onCancel:e[1]||(e[1]=s=>i.value=!1),onSubmit:e[2]||(e[2]=s=>{i.value=!1,r("submit")})},null,8,["modelValue"])]),_:1},8,["modelValue"])}}});export{le as _,te as d,ae as g};
