import{_ as re}from"./LayoutView.vue_vue_type_script_setup_true_lang-DxcI69-q.js";import{g as ne,d as ue}from"./acl.repository-NTvBgMaR.js";import{p as ie,g as de,c as y,t as p,au as ce,C as me,f as pe,h as l,F as D,i as S,Y as ge,r as h,aq as ve,ad as fe,o as be,a0 as P,a1 as F,a2 as r,ab as G,a8 as A,av as he,af as Ve,ac as q,a6 as H,a7 as _e,a5 as Pe}from"./index-_dW35LJ9.js";import{V as ye,a as U}from"./VRow-Dex7Pfo1.js";import{V as Se}from"./VTextField-BZDLI70u.js";import{V as Te}from"./filter-B7hWuaSj.js";import{b as we,V as xe,c as De}from"./VList-MKxnMQsT.js";import{m as Ce,a as ke,b as Be,c as Le,d as Re,e as Ie,f as Ne,u as Ee,p as Fe,g as Ge,h as Ae,i as qe,j as He,k as Ue,l as je,V as j,n as z,o as M,q as O}from"./VDataTable-Dcdllbhv.js";import"./VSheet-DiGYqssP.js";import"./VSlideGroup-n9Q6nBr0.js";import"./ssrBoot-CQs2aLE0.js";const ze=ie({itemsLength:{type:[Number,String],required:!0},...Ce(),...ke(),...Be()},"VDataTableServer"),Me=de()({name:"VDataTableServer",props:ze(),emits:{"update:modelValue":a=>!0,"update:page":a=>!0,"update:itemsPerPage":a=>!0,"update:sortBy":a=>!0,"update:options":a=>!0,"update:expanded":a=>!0,"update:groupBy":a=>!0},setup(a,V){let{attrs:d,slots:e}=V;const{groupBy:c}=Le(a),{sortBy:u,multiSort:m,mustSort:T}=Re(a),{page:g,itemsPerPage:f}=Ie(a),w=y(()=>parseInt(a.itemsLength,10)),{columns:_,headers:v}=Ne(a,{groupBy:c,showSelect:p(a,"showSelect"),showExpand:p(a,"showExpand")}),{items:t}=Ee(a,_),{toggleSort:s}=Fe({sortBy:u,multiSort:m,mustSort:T,page:g}),{opened:o,isGroupOpen:i,toggleGroup:C,extractRows:$}=Ge({groupBy:c,sortBy:u}),{pageCount:W,setItemsPerPage:Y}=Ae({page:g,itemsPerPage:f,itemsLength:w}),{flatItems:k}=qe(t,c,o),{isSelected:J,select:K,selectAll:Q,toggleSelect:X,someSelected:Z,allSelected:ee}=He(a,{allItems:t,currentPage:t}),{isExpanded:ae,toggleExpand:te}=Ue(a),B=y(()=>$(t.value));je({page:g,itemsPerPage:f,sortBy:u,groupBy:c,search:p(a,"search")}),ce("v-data-table",{toggleSort:s,sortBy:u}),me({VDataTableRows:{hideNoData:p(a,"hideNoData"),noDataText:p(a,"noDataText"),loading:p(a,"loading"),loadingText:p(a,"loadingText")}});const n=y(()=>({page:g.value,itemsPerPage:f.value,sortBy:u.value,pageCount:W.value,toggleSort:s,setItemsPerPage:Y,someSelected:Z.value,allSelected:ee.value,isSelected:J,select:K,selectAll:Q,toggleSelect:X,isExpanded:ae,toggleExpand:te,isGroupOpen:i,toggleGroup:C,items:B.value.map(x=>x.raw),internalItems:B.value,groupedItems:k.value,columns:_.value,headers:v.value}));pe(()=>{const x=j.filterProps(a),le=z.filterProps(a),oe=M.filterProps(a),se=O.filterProps(a);return l(O,S({class:["v-data-table",{"v-data-table--loading":a.loading},a.class],style:a.style},se),{top:()=>{var b;return(b=e.top)==null?void 0:b.call(e,n.value)},default:()=>{var b,L,R,I,N,E;return e.default?e.default(n.value):l(D,null,[(b=e.colgroup)==null?void 0:b.call(e,n.value),l("thead",{class:"v-data-table__thead",role:"rowgroup"},[l(z,S(le,{sticky:a.fixedHeader}),e)]),(L=e.thead)==null?void 0:L.call(e,n.value),l("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[(R=e["body.prepend"])==null?void 0:R.call(e,n.value),e.body?e.body(n.value):l(M,S(d,oe,{items:k.value}),e),(I=e["body.append"])==null?void 0:I.call(e,n.value)]),(N=e.tbody)==null?void 0:N.call(e,n.value),(E=e.tfoot)==null?void 0:E.call(e,n.value)])},bottom:()=>e.bottom?e.bottom(n.value):l(j,x,{prepend:e["footer.prepend"]})})})}}),ta=ge({__name:"Roles",setup(a){const V=h(!1),d=h(!1),e=h(""),c=ve(),u=h([]),m=h({current_page:1,per_page:10,total:0,to:2}),{setBreadcrumbs:T}=fe();T([{title:"ACL",name:"true",to:""}]);const g=[{title:"Nome",value:"name"},{title:"Nível",value:"level"},{title:"Permissões",value:"scopes_count"},{title:"Padrão",value:"is_default"},{value:"actions",align:"center",width:"2%"}],f=[{title:"Visualizar",action:t=>{c.push({name:"management.acl.edit",params:{id:t.id}})}},{title:"Excluir",show:t=>!t.is_default,action:t=>{d.value=!0,ue(t.id).then(()=>{v()}).catch(s=>{console.error(s)}).finally(()=>{d.value=!1})}}],w=y(()=>{let t=[];return e.value?(t=u.value.filter(s=>{var o;if((o=s.name)!=null&&o.toLocaleLowerCase().includes(e.value.toLocaleLowerCase()))return s}),t):u.value}),_=(t,s)=>{const o=s.item;c.push({name:"management.acl.edit",params:{id:o.id}})},v=()=>{V.value=!0,d.value=!0,ne(m.value).then(t=>{u.value=t.data.data,m.value={current_page:t.data.current_page,per_page:t.data.per_page,total:t.data.total,to:t.data.to}}).catch(()=>{}).finally(()=>{V.value=!1,d.value=!1})};return be(()=>{v()}),(t,s)=>(P(),F(re,{icon:"mdi-shield-key-outline",title:"ACL"},{action:r(()=>[l(A,{color:"primary",to:{name:"management.acl.create"}},{default:r(()=>[G(" Nova Role ")]),_:1},8,["to"])]),content:r(()=>[l(Me,{headers:g,items:w.value,hover:"","onClick:row":_,loading:d.value,"items-length":m.value.total,"items-per-page":m.value.per_page,"onUpdate:itemsPerPage":[s[1]||(s[1]=o=>m.value.per_page=o),v],"onUpdate:page":v},{top:r(()=>[l(ye,null,{default:r(()=>[l(U,{cols:"12",md:"4",class:"d-flex align-center"},{default:r(()=>[l(Se,{density:"compact","hide-details":"auto",placeholder:"Pesquisar...","append-inner-icon":"mdi-magnify",variant:"outlined",modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=o=>e.value=o)},null,8,["modelValue"])]),_:1}),l(he),l(U,{cols:"12",md:"2",class:"d-flex align-center justify-end"})]),_:1})]),"item.is_default":r(({item:o})=>[Ve("span",null,q(o.is_default?"Sim":"Não"),1)]),"item.actions":r(({item:o})=>[l(Te,{location:"right"},{activator:r(({props:i})=>[l(A,S({icon:"mdi-dots-horizontal",variant:"plain"},i),null,16)]),default:r(()=>[l(we,null,{default:r(()=>[(P(),H(D,null,_e(f,i=>(P(),H(D,null,[!i.show||i.show(o)?(P(),F(xe,{key:0,onClick:C=>i.action({...o})},{default:r(()=>[l(De,null,{default:r(()=>[G(q(i.title),1)]),_:2},1024)]),_:2},1032,["onClick"])):Pe("",!0)],64))),64))]),_:2},1024)]),_:2},1024)]),_:1},8,["items","loading","items-length","items-per-page"])]),_:1}))}});export{ta as default};
