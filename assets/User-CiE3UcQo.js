import{_ as B}from"./LayoutView.vue_vue_type_script_setup_true_lang-IMetWSzZ.js";import{_ as E}from"./Dialog.vue_vue_type_script_setup_true_lang-CiiCaPsN.js";import{g as I}from"./acl.repository-D4gBC5dN.js";import{Y as A,r as d,c as x,aD as q,o as F,a0 as _,a1 as D,a2 as n,i as y,af as j,ak as z,a5 as L,h as g,ab as k,a8 as T,a6 as b,a7 as J,F as C,ac as R}from"./index-eSwy3xtz.js";import{V as P}from"./VTextField-MS4vxye7.js";import{V as M}from"./filter-WSIZa-5s.js";import{b as Y,V as G,c as H}from"./VList-Ck199v2W.js";import{V as K}from"./VDataTableServer-gIGcQsqo.js";import"./VRow-CBFz3Dht.js";import"./VSheet-D4hldqhc.js";import"./Form.vue_vue_type_script_setup_true_lang-BEkuAhzz.js";import"./VTooltip-DEFrmTcV.js";import"./index-C-zpw9ZX.js";import"./validator-CPDVkU8G.js";import"./VSelectionControl--XLGJQvK.js";import"./VForm-DmbiyfSH.js";import"./VSlideGroup-04aVnn54.js";import"./ssrBoot-Bs0WsREi.js";import"./VDataTable-DppTqyZv.js";function O(){return new Promise((v,l)=>{const e={id:1,name:"Administrador"};setTimeout(()=>{const i=[{id:1,name:"João",email:"",created_at:new Date().toLocaleDateString(),updated_at:new Date().toLocaleDateString(),role_id:e.id,role:e},{id:2,name:"Jonathas",email:"",created_at:new Date().toLocaleDateString(),updated_at:new Date().toLocaleDateString(),role_id:e.id,role:{id:1,name:"Administrador"}},{id:3,name:"Igor",email:"",created_at:new Date().toLocaleDateString(),updated_at:new Date().toLocaleDateString(),role_id:e.id,role:{id:1,name:"Administrador"}}];v({data:{data:i}})},1500)})}function Q(v){return new Promise((l,e)=>{setTimeout(()=>{l({data:{id:1,name:"João",email:"",created_at:new Date().toLocaleDateString(),updated_at:new Date().toLocaleDateString(),role:{id:1,name:"Administrador"}}})},1500)})}function W(v,l){return new Promise((e,i)=>{setTimeout(()=>{e({data:{id:1,name:"João",email:"",created_at:new Date().toLocaleDateString(),updated_at:new Date().toLocaleDateString(),role:{id:1,name:"Administrador"}}})},1500)})}function X(v){return new Promise((l,e)=>{setTimeout(()=>{l({data:!0})},2e3)})}const Z=A({__name:"UserDialog",props:{modelValue:{type:Boolean},user:{}},emits:["update:modelValue","update:user","save","close"],setup(v,{emit:l}){const e=v,i=l,V=d(!1),t=x({get:()=>e.user,set:u=>i("update:user",u)}),c=x(()=>t.value.id!==0),U=x(()=>c.value?"Editar Usuário":"Adicionar Usuário"),m=x({get:()=>e.modelValue,set:u=>i("update:modelValue",u)}),{openAlert:p}=q(),a=d(!1),o=d(!1),s=d([]),S=d({current_page:1,per_page:10,total:0,to:2}),$=d({title:U,form:{value:t,inputs:[{component:"VTextField",value:"name",label:"Nome",required:!0,on:{}},{component:"VTextField",value:"email",label:"Email",required:!0,on:{}},{component:"VAutocomplete",value:"role_id",label:"Permissão",required:!0,props:{items:s,itemTitle:"name",itemValue:"id",loading:o},on:{}},{component:"VTextField",value:"password",label:"Senha",required:!0,props:{"v-if":!1},on:{}},{component:"VTextField",value:"password_confirmation",label:"Confirmação da senha",required:!0,props:{type:"password"},on:{}}]},submit:()=>N()});function h(){o.value=!0,I(S.value).then(u=>{s.value=u.data.data,S.value={current_page:u.data.current_page,per_page:u.data.per_page,total:u.data.total,to:u.data.to}}).catch(()=>{}).finally(()=>{o.value=!1})}function N(){a.value=!0,(c.value?W(t.value.id,t.value):Q(t.value)).then(()=>{m.value=!1,i("save")}).catch(r=>{p("Falha ao salvar user",r)}).finally(()=>{a.value=!1})}return F(()=>{h()}),(u,r)=>(_(),D(E,{loading:a.value,modelValue:m.value,"onUpdate:modelValue":r[3]||(r[3]=f=>m.value=f),width:"400",form:$.value,onClock:r[4]||(r[4]=f=>i("close"))},{"item:password":n(({props:f})=>[c.value?L("",!0):(_(),D(P,y({key:0},f,{modelValue:t.value.password,"onUpdate:modelValue":r[1]||(r[1]=w=>t.value.password=w),type:V.value?"text":"password"}),{"append-inner":n(()=>[j("i",{onClick:r[0]||(r[0]=w=>V.value=!V.value),class:z(`${V.value?"mdi-eye":"mdi-eye-closed"} mdi v-icon notranslate v-theme--light v-icon--size-default v-icon--clickable v-autocomplete__menu-icon`)},null,2)]),_:2},1040,["modelValue","type"]))]),"item:password_confirmation":n(({props:f})=>[c.value?L("",!0):(_(),D(P,y({key:0,modelValue:t.value.password_confirmation,"onUpdate:modelValue":r[2]||(r[2]=w=>t.value.password_confirmation=w)},f,{rules:[...f.rules,w=>t.value.password==w?!0:"Senhas divergentes"]}),null,16,["modelValue","rules"]))]),_:1},8,["loading","modelValue","form"]))}}),we=A({__name:"User",setup(v){const l=d(!0),e=d(!1),i=d({id:0,name:"",email:"",role_id:null,created_at:"",updated_at:"",tenant_id:"",slugs:[],password:"",role:{id:0,name:"",scopes:[]}}),V=[{text:"ID",align:"start",value:"id"},{text:"Nome",value:"name"},{text:"Email",value:"email"},{text:"Função",value:"role.name"},{text:"Data de criação",value:"created_at"},{text:"Data de atualização",value:"updated_at"},{text:"",value:"actions",sortable:!1}],t=d({current_page:1,per_page:10,total:0,to:2}),c=d([]),U=[{title:"Editar",action:p=>{i.value={...p},l.value=!0}},{title:"Excluir",action:p=>{e.value=!0,X(p.id).then(()=>{m()}).catch(a=>{console.error(a)}).finally(()=>{e.value=!1})}}];function m(){e.value=!0,O().then(p=>{c.value=p.data.data}).finally(()=>{e.value=!1})}return F(()=>{m()}),(p,a)=>(_(),D(B,{icon:"mdi-account-supervisor",title:"Usuários"},{action:n(()=>[g(T,{color:"primary",flat:"",onClick:a[0]||(a[0]=o=>l.value=!0)},{default:n(()=>[k(" Novo ")]),_:1})]),content:n(()=>[g(K,{headers:V,items:c.value,hover:"",loading:e.value,"items-length":t.value.total,"items-per-page":t.value.per_page,"onUpdate:itemsPerPage":[a[1]||(a[1]=o=>t.value.per_page=o),m],"onUpdate:page":m},{"item.actions":n(({item:o})=>[g(M,{location:"right"},{activator:n(({props:s})=>[g(T,y({icon:"mdi-dots-horizontal",variant:"plain"},s),null,16)]),default:n(()=>[g(Y,null,{default:n(()=>[(_(),b(C,null,J(U,s=>(_(),b(C,null,[!(s!=null&&s.show)||s.show(o)?(_(),D(G,{key:0,onClick:S=>s.action({...o})},{default:n(()=>[g(H,null,{default:n(()=>[k(R(s.title),1)]),_:2},1024)]),_:2},1032,["onClick"])):L("",!0)],64))),64))]),_:2},1024)]),_:2},1024)]),_:1},8,["items","loading","items-length","items-per-page"]),g(Z,{modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=o=>l.value=o),user:i.value,"onUpdate:user":a[3]||(a[3]=o=>i.value=o),onSave:a[4]||(a[4]=o=>m())},null,8,["modelValue","user"])]),_:1}))}});export{we as default};
