import{_ as U}from"./Dialog.vue_vue_type_script_setup_true_lang-B3VUjE2l.js";import{u as z,c as R,g as M,d as j}from"./totem.repository-D2BaXo3Y.js";import{Y as $,ar as L,c as T,aF as A,r as d,a1 as p,a2 as h,ad as P,o as Y,a3 as o,h as l,ag as G,V as x,ab as m,aw as H,ae as C,a8 as q,a5 as E,ac as V,i as J,a6 as S,a7 as K,F as B,ak as F,ba as O}from"./index-BKCAMHtB.js";import{a as N,V as Q}from"./VRow-CFpyredg.js";import{r as W}from"./VDataTable-BQlvNdma.js";import{V as X}from"./filter-Dhl--26x.js";import{b as Z,V as ee,c as te}from"./VList-DAqeaKwZ.js";import{V as ae}from"./VSheet-CbT8pimE.js";import"./Form.vue_vue_type_script_setup_true_lang-B9xE6XiO.js";import"./VTooltip-DNhxNB5o.js";import"./VSlideGroup-fefg94Nt.js";import"./VTextField-CYevVSB1.js";import"./validator-BSIhhdyp.js";import"./VForm-B8sy0Rqc.js";import"./ssrBoot-B3XYMXay.js";const oe=$({__name:"TotemDialog",props:{modelValue:{type:Boolean},totem:{}},emits:["update:modelValue","update:totem","save","close"],setup(D,{emit:w}){const v=D,b=L(),c=w,i=T({get:()=>v.totem,set:n=>c("update:totem",n)}),s=T(()=>i.value.id!==0),k=T(()=>s.value?"Editar Totem":"Adicionar Totem"),u=T({get:()=>v.modelValue,set:n=>c("update:modelValue",n)}),{openAlert:_}=A(),r=d(!1),f=d({title:k,form:{value:i,inputs:[{component:"VTextField",value:"name",label:"Nome",required:!0,on:{}},{component:"VTextField",value:"department_id",label:"Departamento (Integração)",required:!0,on:{}},{component:"VTextarea",value:"description",label:"Descrição",required:!0,on:{}}]},submit:()=>y()});function y(){r.value=!0,(s.value?z(i.value.id,i.value):R(i.value).then(e=>(b.push({name:"totem.detail",params:{id:e.data.id}}),e))).then(()=>{u.value=!1,c("save")}).catch(e=>{_("Falha ao salvar totem",e)}).finally(()=>{r.value=!1})}return(n,e)=>(p(),h(U,{loading:r.value,modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),width:"400",form:f.value,onClock:e[1]||(e[1]=t=>c("close"))},null,8,["loading","modelValue","form"]))}}),xe=$({__name:"Totem",setup(D){const w=[{title:"ID",value:"id",align:"start",width:"5%"},{title:"Nome",value:"name",align:"start",width:"20%"},{title:"Descrição",value:"description",align:"start",width:"20%"},{title:"Filas",value:"queues_count",align:"start",width:"5%"},{title:"Telas",value:"screens_count",align:"start",width:"5%"},{title:"Última atualização",value:"updated_at",align:"start",width:"13%"},{title:"",value:"actions",align:"center",width:"2%"}],{openAlert:v,closeAlert:b,openConfirmAlert:c}=A(),i=L(),s=d({name:"",description:"",id:0,queues_count:0,screens_count:0,updated_at:""}),{setBreadcrumbs:k}=P(),u=d(!0),_=d([]),r=d(!1);function f(e=!0){e&&(u.value=!0),M().then(t=>{_.value=t.data}).catch(t=>{console.log({error:t}),v("Erro ao carregar totens",t)}).finally(()=>{u.value=!1})}const y=d([{title:"Editar",slug:"totem.update",action:e=>{s.value={...e},r.value=!0}},{title:"Excluir",slug:"totem.delete",action:e=>{c({title:"Excluir Totem",text:`Deseja realmente excluir o totem <span class="text-no-wrap bg-primary pa-1 rounded">${e.name}</span>?`},t=>{t.value=!0,j(e.id).then(()=>{f(!1),n(),b()}).catch(a=>{v("Erro ao excluir totem",a)}).finally(()=>{t.value=!1})})}},{title:"Executar",slug:"totem.view",action(e){i.push({name:"totem.run",params:{id:e.id}})}}]);function n(){s.value={name:"",description:"",id:0,queues_count:0,screens_count:0,updated_at:""}}return Y(()=>{f(),k([{title:"Totens",name:"true",to:""}])}),(e,t)=>(p(),h(ae,{color:"on-surface",rounded:""},{default:o(()=>[l(Q,null,{default:o(()=>[l(N,{class:"d-flex align-center"},{default:o(()=>[G("h1",null,[l(x,{icon:"mdi-monitor-vertical"}),m(" Totens")]),l(H),C(F).acl("totem.create")?(p(),h(q,{key:0,color:"primary",flat:"",onClick:t[0]||(t[0]=a=>r.value=!0)},{default:o(()=>[m(" Novo ")]),_:1})):E("",!0)]),_:1}),l(N,{cols:"12"},{default:o(()=>[l(W,{headers:w,items:_.value,loading:u.value,"items-per-page":-1},{"item.name":o(({item:a})=>[l(C(O),{to:{name:"totem.detail",params:{id:a.id}}},{default:o(()=>[m(V(a.name),1)]),_:2},1032,["to"])]),"item.queues_count":o(({item:a})=>[l(x,{icon:"mdi-format-list-bulleted"}),m(" "+V(a.queues_count),1)]),"item.screens_count":o(({item:a})=>[l(x,{icon:"mdi-monitor"}),m(" "+V(a.screens_count),1)]),"item.updated_at":o(({item:a})=>[l(x,{icon:"mdi-calendar"}),m(" "+V(new Date(a.updated_at).toLocaleString()),1)]),"item.actions":o(({item:a})=>[l(X,{left:""},{activator:o(({props:g})=>[l(q,J(g,{icon:"mdi-dots-horizontal",variant:"text"}),null,16)]),default:o(()=>[l(Z,null,{default:o(()=>[(p(!0),S(B,null,K(y.value,(g,I)=>(p(),S(B,null,[C(F).acl(g.slug)?(p(),h(ee,{link:"",onClick:le=>g.action(a),key:I},{default:o(()=>[l(te,null,{default:o(()=>[m(V(g.title),1)]),_:2},1024)]),_:2},1032,["onClick"])):E("",!0)],64))),256))]),_:2},1024)]),_:2},1024)]),bottom:o(()=>[]),_:2},1032,["items","loading"])]),_:1})]),_:1}),l(oe,{onClose:n,onSave:t[1]||(t[1]=a=>{f(!1),n()}),totem:s.value,"onUpdate:totem":t[2]||(t[2]=a=>s.value=a),modelValue:r.value,"onUpdate:modelValue":t[3]||(t[3]=a=>r.value=a)},null,8,["totem","modelValue"])]),_:1}))}});export{xe as default};
