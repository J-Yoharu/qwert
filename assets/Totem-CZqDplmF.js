import{_ as I}from"./Dialog.vue_vue_type_script_setup_true_lang-CiiCaPsN.js";import{u as U,c as z,g as R,d as j}from"./totem.repository-BJ22GVYN.js";import{Y as F,c as w,aD as L,r as u,a0 as v,a1 as k,aq as M,ad as P,o as Y,a2 as t,h as o,af as G,V as b,ab as s,au as H,a4 as y,a8 as q,a5 as E,ac as x,i as J,a6 as S,a7 as K,F as B,aj as N,b7 as O}from"./index-eSwy3xtz.js";import{a as $,V as Q}from"./VRow-CBFz3Dht.js";import{V as W}from"./VDataTable-DppTqyZv.js";import{V as X}from"./filter-WSIZa-5s.js";import{b as Z,V as ee,c as te}from"./VList-Ck199v2W.js";import{V as ae}from"./VSheet-D4hldqhc.js";import"./Form.vue_vue_type_script_setup_true_lang-BEkuAhzz.js";import"./VTooltip-DEFrmTcV.js";import"./index-C-zpw9ZX.js";import"./VTextField-MS4vxye7.js";import"./validator-CPDVkU8G.js";import"./VSelectionControl--XLGJQvK.js";import"./VForm-DmbiyfSH.js";import"./VSlideGroup-04aVnn54.js";import"./ssrBoot-Bs0WsREi.js";const oe=F({__name:"TotemDialog",props:{modelValue:{type:Boolean},totem:{}},emits:["update:modelValue","update:totem","save","close"],setup(C,{emit:D}){const f=C,m=D,i=w({get:()=>f.totem,set:r=>m("update:totem",r)}),h=w(()=>i.value.id!==0),d=w(()=>h.value?"Editar Totem":"Adicionar Totem"),g=w({get:()=>f.modelValue,set:r=>m("update:modelValue",r)}),{openAlert:V}=L(),c=u(!1),p=u({title:d,form:{value:i,inputs:[{component:"VTextField",value:"name",label:"Nome",required:!0,on:{}},{component:"VTextField",value:"department_id",label:"Departamento (Integração)",required:!0,on:{}},{component:"VTextarea",value:"description",label:"Descrição",required:!0,on:{}}]},submit:()=>_()});function _(){c.value=!0,(h.value?U(i.value.id,i.value):z(i.value)).then(()=>{g.value=!1,m("save")}).catch(n=>{V("Falha ao salvar totem",n)}).finally(()=>{c.value=!1})}return(r,n)=>(v(),k(I,{loading:c.value,modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=l=>g.value=l),width:"400",form:p.value,onClock:n[1]||(n[1]=l=>m("close"))},null,8,["loading","modelValue","form"]))}}),we=F({__name:"Totem",setup(C){const D=[{title:"ID",value:"id",align:"start",width:"5%"},{title:"Nome",value:"name",align:"start",width:"20%"},{title:"Descrição",value:"description",align:"start",width:"20%"},{title:"Filas",value:"queues_count",align:"start",width:"5%"},{title:"Telas",value:"screens_count",align:"start",width:"5%"},{title:"Última atualização",value:"updated_at",align:"start",width:"13%"},{title:"",value:"actions",align:"center",width:"2%"}],{openAlert:f,closeAlert:m,openConfirmAlert:i}=L(),h=M(),d=u({name:"",description:"",id:0,queues_count:0,screens_count:0,updated_at:""}),{setBreadcrumbs:g}=P(),V=u(!0),c=u([]),p=u(!1);function _(l=!0){l&&(V.value=!0),R().then(a=>{c.value=a.data}).catch(a=>{console.log({error:a}),f("Erro ao carregar totens",a)}).finally(()=>{V.value=!1})}const r=u([{title:"Editar",slug:"totem.update",action:l=>{d.value={...l},p.value=!0}},{title:"Excluir",slug:"totem.delete",action:l=>{i({title:"Excluir Totem",text:`Deseja realmente excluir o totem <span class="text-no-wrap bg-primary pa-1 rounded">${l.name}</span>?`},a=>{a.value=!0,j(l.id).then(()=>{_(!1),n(),m()}).catch(e=>{f("Erro ao excluir totem",e)}).finally(()=>{a.value=!1})})}},{title:"Executar",slug:"totem.view",action(l){h.push({name:"totem.run",params:{id:l.id}})}}]);function n(){d.value={name:"",description:"",id:0,queues_count:0,screens_count:0,updated_at:""}}return Y(()=>{_(),g([{title:"Totens",name:"true",to:""}])}),(l,a)=>(v(),k(ae,{color:"on-surface",rounded:""},{default:t(()=>[o(Q,null,{default:t(()=>[o($,{class:"d-flex align-center"},{default:t(()=>[G("h1",null,[o(b,{icon:"mdi-monitor-vertical"}),s(" Totens")]),o(H),y(N).acl("totem.create")?(v(),k(q,{key:0,color:"primary",flat:"",onClick:a[0]||(a[0]=e=>p.value=!0)},{default:t(()=>[s(" Novo ")]),_:1})):E("",!0)]),_:1}),o($,{cols:"12"},{default:t(()=>[o(W,{headers:D,items:c.value,loading:V.value,"items-per-page":-1},{"item.name":t(({item:e})=>[o(y(O),{to:{name:"totem.detail",params:{id:e.id}}},{default:t(()=>[s(x(e.name),1)]),_:2},1032,["to"])]),"item.queues_count":t(({item:e})=>[o(b,{icon:"mdi-format-list-bulleted"}),s(" "+x(e.queues_count),1)]),"item.screens_count":t(({item:e})=>[o(b,{icon:"mdi-monitor"}),s(" "+x(e.screens_count),1)]),"item.updated_at":t(({item:e})=>[o(b,{icon:"mdi-calendar"}),s(" "+x(new Date(e.updated_at).toLocaleString()),1)]),"item.actions":t(({item:e})=>[o(X,{left:""},{activator:t(({props:T})=>[o(q,J(T,{icon:"mdi-dots-horizontal",variant:"text"}),null,16)]),default:t(()=>[o(Z,null,{default:t(()=>[(v(!0),S(B,null,K(r.value,(T,A)=>(v(),S(B,null,[y(N).acl(T.slug)?(v(),k(ee,{link:"",onClick:le=>T.action(e),key:A},{default:t(()=>[o(te,null,{default:t(()=>[s(x(T.title),1)]),_:2},1024)]),_:2},1032,["onClick"])):E("",!0)],64))),256))]),_:2},1024)]),_:2},1024)]),bottom:t(()=>[]),_:2},1032,["items","loading"])]),_:1})]),_:1}),o(oe,{onClose:n,onSave:a[1]||(a[1]=e=>{_(!1),n()}),totem:d.value,"onUpdate:totem":a[2]||(a[2]=e=>d.value=e),modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p.value=e)},null,8,["totem","modelValue"])]),_:1}))}});export{we as default};
